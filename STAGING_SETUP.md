# ConfiguraÃ§Ã£o MCP Server para Staging/HomologaÃ§Ã£o

## âœ… **STATUS: PRONTO PARA STAGING**

O MCP Server foi configurado com suporte completo ao ambiente de staging conforme sua configuraÃ§Ã£o MCP.

## ğŸ“‹ **ConfiguraÃ§Ã£o MCP (claude_desktop_config.json)**

```json
{
  "mcpServers": {
    "filazero-test": {
      "command": "node",
      "args": ["C:\\Users\\ovg19\\Downloads\\FilazeroMcpServer\\filazero-mcp-nodejs\\dist\\index.js"],
      "cwd": "C:\\Users\\ovg19\\Downloads\\FilazeroMcpServer\\filazero-mcp-nodejs",
      "env": {
        "NODE_ENV": "staging",
        "FILAZERO_API_URL": "https://api.staging.filazero.net/",
        "LOG_LEVEL": "debug"
      }
    }
  }
}
```

## ğŸ”§ **ConfiguraÃ§Ãµes Aplicadas**

### Environment DinÃ¢mico
- âœ… **NODE_ENV**: `staging` â†’ Habilita configuraÃ§Ãµes de staging
- âœ… **FILAZERO_API_URL**: `https://api.staging.filazero.net/` â†’ API de staging
- âœ… **LOG_LEVEL**: `debug` â†’ Logs detalhados

### Providers para Staging
```javascript
artesano: 460    // Dev/Staging ID
boticario: 358   // Dev/Staging ID  
nike: 356        // Dev/Staging ID
phoneNoel: 357   // Dev/Staging ID
queueNoel: 357   // Dev/Staging ID
```

### reCAPTCHA Bypass
- âœ… **Automaticamente habilitado** em staging
- âœ… **Tokens vÃ¡lidos** gerados (formato: `BYPASS_V3_*_MCP`)
- âœ… **DuraÃ§Ã£o**: 1 hora por token

## ğŸ§ª **ValidaÃ§Ã£o da ConfiguraÃ§Ã£o**

### Teste Realizado
```bash
ğŸ§ª TESTE DE CONFIGURAÃ‡ÃƒO STAGING
âœ… ConfiguraÃ§Ã£o dinÃ¢mica: OK
âœ… API URL correta: OK  
âœ… Bypass habilitado: OK
âœ… Providers staging: OK
âœ… Token bypass gerado: BYPASS_V3_eyJ2ZXJzaW9uIjoiMy4w...
âœ… reCAPTCHA service usando bypass em staging
```

### Logs Esperados no MCP
```
ğŸš€ Filazero MCP Server (Node.js) iniciado!
ğŸ“¡ Ambiente: staging
ğŸ”— API URL: https://api.staging.filazero.net/
ğŸ“Š Log Level: debug
ğŸ› ï¸ Total de tools: 11

ğŸ” Generating reCAPTCHA token for action: create_ticket
ğŸ¯ Using BYPASS reCAPTCHA service (ENV: staging)
ğŸ” Generating bypass token for action: create_ticket, origin: mcp-server
âœ… Generated bypass token (length: 218)
```

## ğŸ¯ **Funcionalidades DisponÃ­veis**

### Tools MCP
1. `get_terminal` - Buscar terminal por chave
2. `create_ticket` - Criar ticket (COM BYPASS)
3. `get_ticket` - Buscar ticket por ID
4. `cancel_ticket` - Cancelar ticket
5. `checkin_ticket` - Check-in com smart code
6. `confirm_presence` - Confirmar presenÃ§a
7. `get_queue_position` - PosiÃ§Ã£o na fila
8. `get_ticket_prevision` - PrevisÃ£o de atendimento
9. `update_feedback` - Atualizar feedback
10. `get_service` - Buscar serviÃ§o
11. `get_company_template` - Template da empresa

### Bypass reCAPTCHA
- **AutomÃ¡tico**: NÃ£o requer reCAPTCHA real em staging
- **Formato**: `BYPASS_V3_{dados}_{MCP}`  
- **ValidaÃ§Ã£o**: Chave `mcp_filazero_2025`
- **SeguranÃ§a**: Tokens com timestamp e assinatura

## ğŸš¨ **ObservaÃ§Ãµes Importantes**

### API de Staging
- **URL**: `https://api.staging.filazero.net/`
- **Status**: Precisa ter bypass implementado para funcionar 100%
- **Fallback**: Se API staging nÃ£o tiver bypass, pode haver erro 2155

### Dados de Teste
- **Chave terminal**: `1d1373dcf045408aa3b13914f2ac1076`
- **Provider IDs**: Usar IDs de desenvolvimento (460, 358, etc.)
- **Browser UUID**: `f3024fb3-8b10-4d4d-8d93-14c40d98b67d`

### Logs
- **NÃ­vel**: Debug habilitado
- **Output**: Console + arquivo de log
- **Formato**: Timestamp + nÃ­vel + mensagem

## ğŸ”„ **Troubleshooting**

### Se erro reCAPTCHA (2155) em staging:
1. Verificar logs: deve mostrar "Using BYPASS reCAPTCHA service"
2. API staging pode nÃ£o ter bypass implementado
3. Aguardar deploy da API com bypass

### Se provider nÃ£o encontrado:
1. Usar IDs de development/staging (460, 358, etc.)
2. Verificar se terminal existe no ambiente staging

### Se conexÃ£o falha:
1. Verificar URL: `https://api.staging.filazero.net/`
2. Testar acesso manual Ã  API
3. Verificar rede/firewall

## ğŸ‰ **Pronto para Usar!**

O MCP Server estÃ¡ **100% configurado** para staging com:
- âœ… ConfiguraÃ§Ã£o dinÃ¢mica por ambiente
- âœ… API staging correta 
- âœ… Bypass reCAPTCHA habilitado
- âœ… Provider IDs adequados
- âœ… Logs detalhados

**Pode usar normalmente no Claude Desktop com a configuraÃ§Ã£o fornecida!** ğŸš€